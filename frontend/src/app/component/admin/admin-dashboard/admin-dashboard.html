<app-admin-layout>
  <div class="dashboard-content">
    <!-- Page Header -->
    <div class="page-header">
      <div class="header-content">
        <h1>Dashboard Overview</h1>
        <p>Welcome back! Here's what's happening with your system today.</p>
      </div>
      <button mat-icon-button (click)="refreshData()" class="refresh-btn" *ngIf="!isLoading">
        <mat-icon>refresh</mat-icon>
      </button>
    </div>
    
    <!-- Loading Indicator -->
    <div *ngIf="isLoading" class="loading-container">
      <mat-progress-bar mode="indeterminate"></mat-progress-bar>
      <p>Loading dashboard data...</p>
    </div>

    <div *ngIf="!isLoading">
      <!-- First Row: User Statistics -->
      <div class="stats-section">
        <h3 class="section-title">User Management Statistics</h3>
        <div class="stats-grid">
          <mat-card *ngFor="let stat of userStats" class="stat-card clickable-card" 
                    [style.border-left]="'4px solid ' + stat.color"
                    (click)="navigateToPage(stat.title)">
            <mat-card-content>
              <div class="stat-content">
                <div class="stat-icon" [style.background-color]="stat.color">
                  <mat-icon>{{ stat.icon }}</mat-icon>
                </div>
                <div class="stat-info">
                  <h2>{{ stat.value | number }}</h2>
                  <p>{{ stat.title }}</p>
                  <span class="stat-subtitle">{{ stat.subtitle }}</span>
                  <span class="stat-growth" [style.color]="stat.color">{{ stat.growth }}</span>
                  
                  <!-- Progress Bar -->
                  <div class="progress-container">
                    <div class="progress-label">
                      <span>Progress</span>
                      <span>{{ getProgressPercentage(stat) }}%</span>
                    </div>
                    <mat-progress-bar 
                      mode="determinate" 
                      [value]="getProgressPercentage(stat)"
                      [color]="'primary'">
                    </mat-progress-bar>
                  </div>
                </div>
              </div>
            </mat-card-content>
          </mat-card>
        </div>
      </div>

      <!-- Second Row: System Statistics -->
      <div class="stats-section">
        <h3 class="section-title">System Management Statistics</h3>
        <div class="stats-grid">
          <mat-card *ngFor="let stat of systemStats" class="stat-card clickable-card" 
                    [style.border-left]="'4px solid ' + stat.color"
                    (click)="navigateToPage(stat.title)">
            <mat-card-content>
              <div class="stat-content">
                <div class="stat-icon" [style.background-color]="stat.color">
                  <mat-icon>{{ stat.icon }}</mat-icon>
                </div>
                <div class="stat-info">
                  <h2>{{ stat.value | number }}</h2>
                  <p>{{ stat.title }}</p>
                  <span class="stat-subtitle">{{ stat.subtitle }}</span>
                  <span class="stat-growth" [style.color]="stat.color">{{ stat.growth }}</span>
                  
                  <!-- Progress Bar -->
                  <div class="progress-container">
                    <div class="progress-label">
                      <span>Progress</span>
                      <span>{{ getProgressPercentage(stat) }}%</span>
                    </div>
                    <mat-progress-bar 
                      mode="determinate" 
                      [value]="getProgressPercentage(stat)"
                      [color]="'primary'">
                    </mat-progress-bar>
                  </div>
                </div>
              </div>
            </mat-card-content>
          </mat-card>
        </div>
      </div>

      <!-- Third Row: Content Statistics (NEW) -->
      <div class="stats-section" *ngIf="contentStats.length > 0">
        <h3 class="section-title">Content Management Statistics</h3>
        <div class="stats-grid">
          <mat-card *ngFor="let stat of contentStats" class="stat-card clickable-card" 
                    [style.border-left]="'4px solid ' + stat.color"
                    (click)="navigateToPage(stat.title)">
            <mat-card-content>
              <div class="stat-content">
                <div class="stat-icon" [style.background-color]="stat.color">
                  <mat-icon>{{ stat.icon }}</mat-icon>
                </div>
                <div class="stat-info">
                  <h2>{{ stat.value | number }}</h2>
                  <p>{{ stat.title }}</p>
                  <span class="stat-subtitle">{{ stat.subtitle }}</span>
                  <span class="stat-growth" [style.color]="stat.color">{{ stat.growth }}</span>
                  
                  <!-- Progress Bar -->
                  <div class="progress-container">
                    <div class="progress-label">
                      <span>Progress</span>
                      <span>{{ getProgressPercentage(stat) }}%</span>
                    </div>
                    <mat-progress-bar 
                      mode="determinate" 
                      [value]="getProgressPercentage(stat)"
                      [color]="'primary'">
                    </mat-progress-bar>
                  </div>
                </div>
              </div>
            </mat-card-content>
          </mat-card>
        </div>
      </div>

      <!-- Recent Assignments Table -->
      <div class="table-section" *ngIf="adminDashboardStats && adminDashboardStats.recentAssignments.length > 0">
        <h3 class="section-title">
          <mat-icon>assignment</mat-icon>
          Recent Assignments (Last 3)
        </h3>
        <mat-card class="table-card">
          <mat-card-content>
            <table mat-table [dataSource]="adminDashboardStats.recentAssignments" class="modern-table">
              <!-- Subject Column -->
              <ng-container matColumnDef="subject">
                <th mat-header-cell *matHeaderCellDef>Subject</th>
                <td mat-cell *matCellDef="let assignment">
                  <div class="cell-with-icon">
                    <mat-icon color="primary">subject</mat-icon>
                    <span>{{ getSubjectName(assignment.subject) }}</span>
                  </div>
                </td>
              </ng-container>

              <!-- Title Column -->
              <ng-container matColumnDef="title">
                <th mat-header-cell *matHeaderCellDef>Assignment Title</th>
                <td mat-cell *matCellDef="let assignment">
                  <div class="assignment-title-cell">
                    <strong>{{ assignment.title }}</strong>
                    <span class="assignment-description" *ngIf="assignment.description">
                      {{ assignment.description.substring(0, 100) }}{{ assignment.description.length > 100 ? '...' : '' }}
                    </span>
                    <div class="assignment-badges">
                      <span [class]="getAssignmentLevelBadgeClass(assignment.assignmentLevel)">
                        {{ assignment.assignmentLevel }}
                      </span>
                      <span class="badge-type">{{ assignment.assignmentType }}</span>
                    </div>
                  </div>
                </td>
              </ng-container>

              <!-- Modules Column -->
              <ng-container matColumnDef="modules">
                <th mat-header-cell *matHeaderCellDef>Modules</th>
                <td mat-cell *matCellDef="let assignment">
                  <span class="module-count" matTooltip="{{ getModuleNames(assignment.modules) }}">
                    <mat-icon>library_books</mat-icon>
                    {{ assignment.modules?.length || 0 }} module(s)
                  </span>
                </td>
              </ng-container>

              <!-- Total Marks Column -->
              <ng-container matColumnDef="totalMarks">
                <th mat-header-cell *matHeaderCellDef>Marks / Questions</th>
                <td mat-cell *matCellDef="let assignment">
                  <div class="marks-cell">
                    <span class="total-marks">{{ assignment.totalMarks }} marks</span>
                    <span class="question-count">{{ assignment.questionCount }} questions</span>
                  </div>
                </td>
              </ng-container>

              <!-- Due Date Column -->
              <ng-container matColumnDef="dueDate">
                <th mat-header-cell *matHeaderCellDef>Due Date</th>
                <td mat-cell *matCellDef="let assignment">
                  <div class="due-date-cell">
                    <mat-icon>event</mat-icon>
                    <span>{{ formatDate(assignment.dueDate) }}</span>
                  </div>
                </td>
              </ng-container>

              <!-- Duration Column -->
              <ng-container matColumnDef="duration">
                <th mat-header-cell *matHeaderCellDef>Days Remaining</th>
                <td mat-cell *matCellDef="let assignment">
                  <span 
                    class="duration-badge" 
                    [class.urgent]="getDaysRemaining(assignment.dueDate) <= 2"
                    [class.warning]="getDaysRemaining(assignment.dueDate) > 2 && getDaysRemaining(assignment.dueDate) <= 5">
                    <mat-icon>schedule</mat-icon>
                    {{ getDaysRemainingText(getDaysRemaining(assignment.dueDate)) }}
                  </span>
                </td>
              </ng-container>

              <tr mat-header-row *matHeaderRowDef="assignmentColumns"></tr>
              <tr mat-row *matRowDef="let row; columns: assignmentColumns;" class="table-row"></tr>
            </table>
          </mat-card-content>
          <mat-card-actions align="end">
            <button mat-button color="primary" routerLink="/admin/manage-assignments">
              View All Assignments
              <mat-icon>arrow_forward</mat-icon>
            </button>
          </mat-card-actions>
        </mat-card>
      </div>

      <!-- Recent Meetings Table -->
      <div class="table-section" *ngIf="adminDashboardStats && adminDashboardStats.recentMeetings.length > 0">
        <h3 class="section-title">
          <mat-icon>video_call</mat-icon>
          Recent Meetings (Last 3)
        </h3>
        <mat-card class="table-card">
          <mat-card-content>
            <table mat-table [dataSource]="adminDashboardStats.recentMeetings" class="modern-table">
              <!-- Subject Column -->
              <ng-container matColumnDef="subject">
                <th mat-header-cell *matHeaderCellDef>Subject</th>
                <td mat-cell *matCellDef="let meeting">
                  <div class="cell-with-icon">
                    <mat-icon color="primary">subject</mat-icon>
                    <span>{{ getSubjectName(meeting.subject) }}</span>
                  </div>
                </td>
              </ng-container>

              <!-- Topic Column -->
              <ng-container matColumnDef="topic">
                <th mat-header-cell *matHeaderCellDef>Meeting Topic</th>
                <td mat-cell *matCellDef="let meeting">
                  <div class="meeting-topic-cell">
                    <strong>{{ meeting.topic }}</strong>
                    <span class="meeting-description" *ngIf="meeting.description">
                      {{ meeting.description.substring(0, 100) }}{{ meeting.description.length > 100 ? '...' : '' }}
                    </span>
                  </div>
                </td>
              </ng-container>

              <!-- Batch Column -->
              <ng-container matColumnDef="batch">
                <th mat-header-cell *matHeaderCellDef>Batch / Semester</th>
                <td mat-cell *matCellDef="let meeting">
                  <div class="batch-cell">
                    <span class="batch-name">
                      <mat-icon>groups</mat-icon>
                      {{ getBatchName(meeting.batch) }}
                    </span>
                    <span class="semester-name">
                      <mat-icon>event</mat-icon>
                      {{ getSemesterName(meeting.semester) }}
                    </span>
                  </div>
                </td>
              </ng-container>

              <!-- Meeting Date Column -->
              <ng-container matColumnDef="meetingDate">
                <th mat-header-cell *matHeaderCellDef>Date & Time</th>
                <td mat-cell *matCellDef="let meeting">
                  <div class="meeting-datetime-cell">
                    <mat-icon>schedule</mat-icon>
                    <span>{{ formatDateTime(meeting.meetingDate, meeting.startTime) }}</span>
                  </div>
                </td>
              </ng-container>

              <!-- Duration Column -->
              <ng-container matColumnDef="duration">
                <th mat-header-cell *matHeaderCellDef>Duration</th>
                <td mat-cell *matCellDef="let meeting">
                  <span class="duration-chip">
                    <mat-icon>timer</mat-icon>
                    {{ formatDuration(meeting.duration) }}
                  </span>
                </td>
              </ng-container>

              <!-- Status Column -->
              <ng-container matColumnDef="status">
                <th mat-header-cell *matHeaderCellDef>Status</th>
                <td mat-cell *matCellDef="let meeting">
                  <span 
                    class="status-badge" 
                    [style.background-color]="getMeetingStatusColor(meeting.status)"
                    [style.color]="'white'">
                    {{ meeting.status | titlecase }}
                  </span>
                </td>
              </ng-container>

              <tr mat-header-row *matHeaderRowDef="meetingColumns"></tr>
              <tr mat-row *matRowDef="let row; columns: meetingColumns;" class="table-row"></tr>
            </table>
          </mat-card-content>
          <mat-card-actions align="end">
            <button mat-button color="primary" routerLink="/admin/meetings">
              View All Meetings
              <mat-icon>arrow_forward</mat-icon>
            </button>
          </mat-card-actions>
        </mat-card>
      </div>


      <!-- Charts Section -->
      <div class="charts-section">
        <!-- User Statistics Charts -->
        <div class="user-graph-section">
          <div class="charts-row">
            <!-- Left Half - User Distribution Chart -->
            <mat-card class="chart-card modern-card">
              <mat-card-header>
                <mat-card-title>
                  <mat-icon>donut_large</mat-icon>
                  User Distribution
                </mat-card-title>
                <mat-card-subtitle>Total Users: {{ allUsers.length }}</mat-card-subtitle>
              </mat-card-header>
              <mat-card-content>
                <div class="chart-container">
                  <!-- Donut Chart -->
                  <div class="donut-chart-wrapper">
                    <div class="donut-chart">
                      <!-- Center Info -->
                      <div class="chart-center">
                        <span class="total-number">{{ allUsers.length }}</span>
                        <span class="total-label">Total Users</span>
                      </div>
                      
                      <!-- SVG Donut Chart -->
                      <svg width="220" height="220" viewBox="0 0 200 200" class="donut-svg">
                        <!-- Background Circle -->
                        <circle cx="100" cy="100" r="80" fill="none" stroke="#f0f0f0" stroke-width="20"></circle>
                        
                        <!-- Students Arc -->
                        <circle cx="100" cy="100" r="80" fill="none" 
                                stroke="#2196F3" 
                                stroke-width="20"
                                [attr.stroke-dasharray]="getStudentsStrokeDashArray()"
                                class="donut-segment students-segment"
                                transform="rotate(-90 100 100)">
                        </circle>
                        
                        <!-- Teachers Arc -->
                        <circle cx="100" cy="100" r="80" fill="none" 
                                stroke="#4CAF50" 
                                stroke-width="20"
                                [attr.stroke-dasharray]="getTeachersStrokeDashArray()"
                                class="donut-segment teachers-segment"
                                [attr.transform]="'rotate(' + getTeachersRotation() + ' 100 100)'">
                        </circle>
                        
                        <!-- Admins Arc -->
                        <circle cx="100" cy="100" r="80" fill="none" 
                                stroke="#FF9800" 
                                stroke-width="20"
                                [attr.stroke-dasharray]="getAdminsStrokeDashArray()"
                                class="donut-segment admins-segment"
                                [attr.transform]="'rotate(' + getAdminsRotation() + ' 100 100)'">
                        </circle>
                      </svg>
                    </div>
                    
                    <!-- Legend with Percentages -->
                    <div class="chart-legend-compact">
                      <div class="legend-item-compact">
                        <div class="legend-color students-color"></div>
                        <span class="legend-label-compact">Students</span>
                        <span class="legend-percentage">{{ getPercentage('students') }}%</span>
                      </div>
                      <div class="legend-item-compact">
                        <div class="legend-color teachers-color"></div>
                        <span class="legend-label-compact">Teachers</span>
                        <span class="legend-percentage">{{ getPercentage('teachers') }}%</span>
                      </div>
                      <div class="legend-item-compact">
                        <div class="legend-color admins-color"></div>
                        <span class="legend-label-compact">Admins</span>
                        <span class="legend-percentage">{{ getPercentage('admins') }}%</span>
                      </div>
                    </div>
                  </div>
                </div>
              </mat-card-content>
            </mat-card>

            <!-- Right Half - User Status Chart -->
            <mat-card class="chart-card modern-card">
              <mat-card-header>
                <mat-card-title>
                  <mat-icon>assessment</mat-icon>
                  User Status
                </mat-card-title>
                <mat-card-subtitle>Status Distribution</mat-card-subtitle>
              </mat-card-header>
              <mat-card-content>
                <div class="status-chart-container">
                  <!-- Status Donut Chart -->
                  <div class="donut-chart-wrapper">
                    <div class="donut-chart">
                      <!-- Center Info -->
                      <div class="chart-center">
                        <span class="total-number">{{ allUsers.length }}</span>
                        <span class="total-label">Total Users</span>
                      </div>
                      
                      <!-- SVG Status Donut Chart -->
                      <svg width="220" height="220" viewBox="0 0 200 200" class="donut-svg">
                        <!-- Background Circle -->
                        <circle cx="100" cy="100" r="80" fill="none" stroke="#f0f0f0" stroke-width="20"></circle>
                        
                        <!-- Active Users Arc -->
                        <circle cx="100" cy="100" r="80" fill="none" 
                                stroke="#4CAF50" 
                                stroke-width="20"
                                [attr.stroke-dasharray]="getActiveStrokeDashArray()"
                                class="donut-segment active-segment"
                                transform="rotate(-90 100 100)"
                                *ngIf="getActiveUsersCount() > 0">
                        </circle>
                        
                        <!-- Pending Users Arc -->
                        <circle cx="100" cy="100" r="80" fill="none" 
                                stroke="#FF9800" 
                                stroke-width="20"
                                [attr.stroke-dasharray]="getPendingStrokeDashArray()"
                                class="donut-segment pending-segment"
                                [attr.transform]="'rotate(' + getPendingRotation() + ' 100 100)'"
                                *ngIf="getPendingUsersCount() > 0">
                        </circle>
                        
                        <!-- Rejected Users Arc -->
                        <circle cx="100" cy="100" r="80" fill="none" 
                                stroke="#f44336" 
                                stroke-width="20"
                                [attr.stroke-dasharray]="getRejectedStrokeDashArray()"
                                class="donut-segment rejected-segment"
                                [attr.transform]="'rotate(' + getRejectedRotation() + ' 100 100)'"
                                *ngIf="getRejectedUsersCount() > 0">
                        </circle>
                      </svg>
                    </div>
                    
                    <!-- Status Legend with Percentages -->
                    <div class="chart-legend-compact">
                      <div class="legend-item-compact">
                        <div class="legend-color active-color"></div>
                        <span class="legend-label-compact">Active</span>
                        <span class="legend-percentage">{{ getStatusPercentage('active') }}%</span>
                      </div>
                      <div class="legend-item-compact" *ngIf="getPendingUsersCount() > 0">
                        <div class="legend-color pending-color"></div>
                        <span class="legend-label-compact">Pending</span>
                        <span class="legend-percentage">{{ getStatusPercentage('pending') }}%</span>
                      </div>
                      <div class="legend-item-compact" *ngIf="getRejectedUsersCount() > 0">
                        <div class="legend-color rejected-color"></div>
                        <span class="legend-label-compact">Rejected</span>
                        <span class="legend-percentage">{{ getStatusPercentage('rejected') }}%</span>
                      </div>
                    </div>
                  </div>
                  
                  <!-- Status Summary Cards -->
                  <div class="status-cards">
                    <div class="status-card active-card">
                      <mat-icon>check_circle</mat-icon>
                      <span class="status-count">{{ getActiveUsersCount() }}</span>
                      <span class="status-label">Active</span>
                    </div>
                    <div class="status-card pending-card">
                      <mat-icon>schedule</mat-icon>
                      <span class="status-count">{{ getPendingUsersCount() }}</span>
                      <span class="status-label">Pending</span>
                    </div>
                    <div class="status-card rejected-card">
                      <mat-icon>cancel</mat-icon>
                      <span class="status-count">{{ getRejectedUsersCount() }}</span>
                      <span class="status-label">Rejected</span>
                    </div>
                  </div>
                </div>
              </mat-card-content>
            </mat-card>
          </div>
        </div>
      </div>

      <!-- NEW: Meetings and Assignments Analytics Graphs -->
      <div class="charts-section" *ngIf="adminDashboardStats">
        <div class="charts-row">
          <!-- Meetings Status Chart -->
          <mat-card class="chart-card modern-card">
            <mat-card-header>
              <mat-card-title>
                <mat-icon>video_call</mat-icon>
                Meeting Statistics
              </mat-card-title>
              <mat-card-subtitle>Total Meetings: {{ adminDashboardStats.meetings.total }}</mat-card-subtitle>
            </mat-card-header>
            <mat-card-content>
              <div class="chart-container">
                <div class="donut-chart-wrapper">
                  <div class="donut-chart">
                    <!-- Center Info -->
                    <div class="chart-center">
                      <span class="total-number">{{ adminDashboardStats.meetings.total }}</span>
                      <span class="total-label">Total Meetings</span>
                    </div>
                    
                    <!-- SVG Meetings Donut Chart -->
                    <svg width="220" height="220" viewBox="0 0 200 200" class="donut-svg">
                      <!-- Background Circle -->
                      <circle cx="100" cy="100" r="80" fill="none" stroke="#f0f0f0" stroke-width="20"></circle>
                      
                      <!-- Scheduled Arc -->
                      <circle cx="100" cy="100" r="80" fill="none" 
                              stroke="#2196F3" 
                              stroke-width="20"
                              [attr.stroke-dasharray]="getMeetingsStrokeDashArray('scheduled')"
                              class="donut-segment"
                              transform="rotate(-90 100 100)"
                              *ngIf="adminDashboardStats.meetings.scheduled > 0">
                      </circle>
                      
                      <!-- Ongoing Arc -->
                      <circle cx="100" cy="100" r="80" fill="none" 
                              stroke="#4CAF50" 
                              stroke-width="20"
                              [attr.stroke-dasharray]="getMeetingsStrokeDashArray('ongoing')"
                              class="donut-segment"
                              [attr.transform]="'rotate(' + getMeetingsRotation('ongoing') + ' 100 100)'"
                              *ngIf="adminDashboardStats.meetings.ongoing > 0">
                      </circle>
                      
                      <!-- Completed Arc -->
                      <circle cx="100" cy="100" r="80" fill="none" 
                              stroke="#757575" 
                              stroke-width="20"
                              [attr.stroke-dasharray]="getMeetingsStrokeDashArray('completed')"
                              class="donut-segment"
                              [attr.transform]="'rotate(' + getMeetingsRotation('completed') + ' 100 100)'"
                              *ngIf="adminDashboardStats.meetings.completed > 0">
                      </circle>
                      
                      <!-- Cancelled Arc -->
                      <circle cx="100" cy="100" r="80" fill="none" 
                              stroke="#f44336" 
                              stroke-width="20"
                              [attr.stroke-dasharray]="getMeetingsStrokeDashArray('cancelled')"
                              class="donut-segment"
                              [attr.transform]="'rotate(' + getMeetingsRotation('cancelled') + ' 100 100)'"
                              *ngIf="adminDashboardStats.meetings.cancelled > 0">
                      </circle>
                    </svg>
                  </div>
                  
                  <!-- Meetings Legend -->
                  <div class="chart-legend-compact">
                    <div class="legend-item-compact">
                      <div class="legend-color" style="background-color: #2196F3;"></div>
                      <span class="legend-label-compact">Scheduled</span>
                      <span class="legend-percentage">{{ getMeetingPercentage('scheduled') }}%</span>
                      <span class="legend-count">({{ adminDashboardStats.meetings.scheduled }})</span>
                    </div>
                    <div class="legend-item-compact" *ngIf="adminDashboardStats.meetings.ongoing > 0">
                      <div class="legend-color" style="background-color: #4CAF50;"></div>
                      <span class="legend-label-compact">Ongoing</span>
                      <span class="legend-percentage">{{ getMeetingPercentage('ongoing') }}%</span>
                      <span class="legend-count">({{ adminDashboardStats.meetings.ongoing }})</span>
                    </div>
                    <div class="legend-item-compact">
                      <div class="legend-color" style="background-color: #757575;"></div>
                      <span class="legend-label-compact">Completed</span>
                      <span class="legend-percentage">{{ getMeetingPercentage('completed') }}%</span>
                      <span class="legend-count">({{ adminDashboardStats.meetings.completed }})</span>
                    </div>
                    <div class="legend-item-compact" *ngIf="adminDashboardStats.meetings.cancelled > 0">
                      <div class="legend-color" style="background-color: #f44336;"></div>
                      <span class="legend-label-compact">Cancelled</span>
                      <span class="legend-percentage">{{ getMeetingPercentage('cancelled') }}%</span>
                      <span class="legend-count">({{ adminDashboardStats.meetings.cancelled }})</span>
                    </div>
                  </div>
                </div>
              </div>
            </mat-card-content>
          </mat-card>

          <!-- Assignments Status Chart -->
          <mat-card class="chart-card modern-card">
            <mat-card-header>
              <mat-card-title>
                <mat-icon>assignment</mat-icon>
                Assignment Statistics
              </mat-card-title>
              <mat-card-subtitle>Total Assignments: {{ adminDashboardStats.assignments.total }}</mat-card-subtitle>
            </mat-card-header>
            <mat-card-content>
              <div class="chart-container">
                <div class="donut-chart-wrapper">
                  <div class="donut-chart">
                    <!-- Center Info -->
                    <div class="chart-center">
                      <span class="total-number">{{ adminDashboardStats.assignments.total }}</span>
                      <span class="total-label">Total Assignments</span>
                    </div>
                    
                    <!-- SVG Assignments Donut Chart -->
                    <svg width="220" height="220" viewBox="0 0 200 200" class="donut-svg">
                      <!-- Background Circle -->
                      <circle cx="100" cy="100" r="80" fill="none" stroke="#f0f0f0" stroke-width="20"></circle>
                      
                      <!-- Active Arc -->
                      <circle cx="100" cy="100" r="80" fill="none" 
                              stroke="#2196F3" 
                              stroke-width="20"
                              [attr.stroke-dasharray]="getAssignmentsStrokeDashArray('active')"
                              class="donut-segment"
                              transform="rotate(-90 100 100)"
                              *ngIf="adminDashboardStats.assignments.active > 0">
                      </circle>
                      
                      <!-- Pending Arc -->
                      <circle cx="100" cy="100" r="80" fill="none" 
                              stroke="#FF9800" 
                              stroke-width="20"
                              [attr.stroke-dasharray]="getAssignmentsStrokeDashArray('pending')"
                              class="donut-segment"
                              [attr.transform]="'rotate(' + getAssignmentsRotation('pending') + ' 100 100)'"
                              *ngIf="adminDashboardStats.assignments.pending > 0">
                      </circle>
                      
                      <!-- Completed Arc -->
                      <circle cx="100" cy="100" r="80" fill="none" 
                              stroke="#4CAF50" 
                              stroke-width="20"
                              [attr.stroke-dasharray]="getAssignmentsStrokeDashArray('completed')"
                              class="donut-segment"
                              [attr.transform]="'rotate(' + getAssignmentsRotation('completed') + ' 100 100)'"
                              *ngIf="adminDashboardStats.assignments.completed > 0">
                      </circle>
                    </svg>
                  </div>
                  
                  <!-- Assignments Legend -->
                  <div class="chart-legend-compact">
                    <div class="legend-item-compact">
                      <div class="legend-color" style="background-color: #2196F3;"></div>
                      <span class="legend-label-compact">Active</span>
                      <span class="legend-percentage">{{ getAssignmentPercentage('active') }}%</span>
                      <span class="legend-count">({{ adminDashboardStats.assignments.active }})</span>
                    </div>
                    <div class="legend-item-compact">
                      <div class="legend-color" style="background-color: #FF9800;"></div>
                      <span class="legend-label-compact">Pending</span>
                      <span class="legend-percentage">{{ getAssignmentPercentage('pending') }}%</span>
                      <span class="legend-count">({{ adminDashboardStats.assignments.pending }})</span>
                    </div>
                    <div class="legend-item-compact">
                      <div class="legend-color" style="background-color: #4CAF50;"></div>
                      <span class="legend-label-compact">Completed</span>
                      <span class="legend-percentage">{{ getAssignmentPercentage('completed') }}%</span>
                      <span class="legend-count">({{ adminDashboardStats.assignments.completed }})</span>
                    </div>
                  </div>
                  
                  <!-- Additional Stats -->
                  <div class="status-cards" style="margin-top: 20px;">
                    <div class="status-card" style="background: linear-gradient(135deg, #e3f2fd 0%, #bbdefb 100%);">
                      <mat-icon style="color: #2196F3;">check_circle</mat-icon>
                      <span class="status-count">{{ adminDashboardStats.assignments.submissions }}</span>
                      <span class="status-label">Submissions</span>
                    </div>
                  </div>
                </div>
              </div>
            </mat-card-content>
          </mat-card>
        </div>
      </div>

    

      <!-- Quick Actions -->
      <div class="dashboard-grid">
        <mat-card class="quick-actions-card">
          <mat-card-header>
            <mat-card-title>
              <mat-icon>flash_on</mat-icon>
              Quick Actions
            </mat-card-title>
          </mat-card-header>
          <mat-card-content>
            <div class="action-buttons">
              <button mat-raised-button color="primary" class="action-btn" routerLink="/admin/manage-students">
                <mat-icon>person_add</mat-icon>
                Manage Students
              </button>
              <button mat-raised-button color="accent" class="action-btn" routerLink="/admin/manage-lecturers">
                <mat-icon>person_add</mat-icon>
                Manage Teachers
              </button>
              <button mat-raised-button color="warn" class="action-btn" routerLink="/admin/manage-admins">
                <mat-icon>admin_panel_settings</mat-icon>
                Manage Admins
              </button>
              <button mat-raised-button style="background-color: #4caf50; color: white;" class="action-btn" routerLink="/admin/manage-departments">
                <mat-icon>domain</mat-icon>
                Manage Departments
              </button>
              <button mat-raised-button style="background-color: #ff9800; color: white;" class="action-btn" routerLink="/admin/manage-courses">
                <mat-icon>school</mat-icon>
                Manage Courses
              </button>
              <button mat-raised-button style="background-color: #9c27b0; color: white;" class="action-btn" routerLink="/admin/manage-batches">
                <mat-icon>groups</mat-icon>
                Manage Batches
              </button>
              <button mat-raised-button style="background-color: #3f51b5; color: white;" class="action-btn" routerLink="/admin/manage-semesters">
                <mat-icon>event</mat-icon>
                Manage Semesters
              </button>
              <button mat-stroked-button class="action-btn" (click)="refreshData()">
                <mat-icon>refresh</mat-icon>
                Refresh Data
              </button>
            </div>
          </mat-card-content>
        </mat-card>
      </div>
    </div>
  </div>
</app-admin-layout>
