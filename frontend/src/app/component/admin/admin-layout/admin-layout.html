<div class="admin-layout" [class.sidebar-collapsed]="sidebarCollapsed">
  <!-- Sidebar -->
  <mat-sidenav-container class="sidenav-container">
    <mat-sidenav
      #drawer
      mode="side" 
      opened="true"
      class="sidenav"
      [class.collapsed]="sidebarCollapsed"
      fixedInViewport="true">
      
      <!-- Sidebar Header -->
      <div class="sidebar-header">
        <div class="logo-container">
          <div class="logo-circle">
            <mat-icon>school</mat-icon>
          </div>
          <h2 *ngIf="!sidebarCollapsed" class="logo-text">Smart LMS</h2>
        </div>
        <button mat-icon-button (click)="toggleSidebar()" class="toggle-btn">
          <mat-icon>{{ sidebarCollapsed ? 'menu_open' : 'menu' }}</mat-icon>
        </button>
      </div>
      
      <!-- Navigation Menu -->
      <nav class="sidebar-nav">
        <!-- Dashboard -->
        <div class="nav-item" routerLinkActive="active" routerLink="/admin/dashboard" [attr.data-tooltip]="sidebarCollapsed ? 'Dashboard' : null">
          <div class="nav-content">
            <mat-icon class="nav-icon">dashboard</mat-icon>
            <span *ngIf="!sidebarCollapsed" class="nav-text">Dashboard</span>
          </div>
        </div>

        <!-- User Management -->
        <div class="nav-item expandable" [class.expanded]="userManagementExpanded && !sidebarCollapsed" [class.has-active-child]="hasActiveUserManagementChild()" [attr.data-tooltip]="sidebarCollapsed ? 'User Management' : null">
          <div class="nav-content" (click)="toggleUserManagement()">
            <mat-icon class="nav-icon">people</mat-icon>
            <span *ngIf="!sidebarCollapsed" class="nav-text">User Management</span>
            <mat-icon *ngIf="!sidebarCollapsed" class="expand-icon">{{ userManagementExpanded ? 'expand_less' : 'expand_more' }}</mat-icon>
          </div>
          
          <!-- Sub-menu for User Management -->
          <div class="sub-menu" *ngIf="userManagementExpanded && !sidebarCollapsed">
            <div class="sub-nav-item" routerLinkActive="active" routerLink="/admin/manage-students">
              <mat-icon class="sub-icon">school</mat-icon>
              <span class="sub-text">Students</span>
            </div>
            <div class="sub-nav-item" routerLinkActive="active" routerLink="/admin/manage-lecturers">
              <mat-icon class="sub-icon">person</mat-icon>
              <span class="sub-text">Lecturers</span>
            </div>
            <div class="sub-nav-item" routerLinkActive="active" routerLink="/admin/manage-admins">
              <mat-icon class="sub-icon">admin_panel_settings</mat-icon>
              <span class="sub-text">Admins</span>
            </div>
          </div>
        </div>

        <!-- Departments Management -->
        <div class="nav-item" routerLinkActive="active" routerLink="/admin/manage-departments" [attr.data-tooltip]="sidebarCollapsed ? 'Departments' : null">
          <div class="nav-content">
            <mat-icon class="nav-icon">account_balance</mat-icon>
            <span *ngIf="!sidebarCollapsed" class="nav-text">Departments</span>
          </div>
        </div>

        <!-- Courses Management -->
        <div class="nav-item" routerLinkActive="active" routerLink="/admin/manage-courses" [attr.data-tooltip]="sidebarCollapsed ? 'Courses' : null">
          <div class="nav-content">
            <mat-icon class="nav-icon">school</mat-icon>
            <span *ngIf="!sidebarCollapsed" class="nav-text">Courses</span>
          </div>
        </div>

        <!-- Batches Management -->
        <div class="nav-item" routerLinkActive="active" routerLink="/admin/manage-batches" [attr.data-tooltip]="sidebarCollapsed ? 'Batches' : null">
          <div class="nav-content">
            <mat-icon class="nav-icon">groups</mat-icon>
            <span *ngIf="!sidebarCollapsed" class="nav-text">Batches</span>
          </div>
        </div>

        <!-- Semesters Management -->
        <div class="nav-item" routerLinkActive="active" routerLink="/admin/manage-semesters" [attr.data-tooltip]="sidebarCollapsed ? 'Semesters' : null">
          <div class="nav-content">
            <mat-icon class="nav-icon">event_note</mat-icon>
            <span *ngIf="!sidebarCollapsed" class="nav-text">Semesters</span>
          </div>
        </div>

        <!-- Subjects Management -->
        <div class="nav-item" routerLinkActive="active" routerLink="/admin/manage-subjects" [attr.data-tooltip]="sidebarCollapsed ? 'Subjects' : null">
          <div class="nav-content">
            <mat-icon class="nav-icon">subject</mat-icon>
            <span *ngIf="!sidebarCollapsed" class="nav-text">Subjects</span>
          </div>
        </div>

        <!-- Modules Management -->
        <div class="nav-item" routerLinkActive="active" routerLink="/admin/manage-modules" [attr.data-tooltip]="sidebarCollapsed ? 'Modules' : null">
          <div class="nav-content">
            <mat-icon class="nav-icon">view_module</mat-icon>
            <span *ngIf="!sidebarCollapsed" class="nav-text">Modules</span>
          </div>
        </div>

        <!-- Extra Modules Management -->
        <div class="nav-item" routerLinkActive="active" routerLink="/admin/manage-extra-modules" [attr.data-tooltip]="sidebarCollapsed ? 'Extra Modules' : null">
          <div class="nav-content">
            <mat-icon class="nav-icon">extension</mat-icon>
            <span *ngIf="!sidebarCollapsed" class="nav-text">Extra Modules</span>
          </div>
        </div>

        <!-- Assignments Management -->
        <div class="nav-item" routerLinkActive="active" routerLink="/admin/manage-assignments" [routerLinkActiveOptions]="{exact: true}" [attr.data-tooltip]="sidebarCollapsed ? 'Assignments' : null">
          <div class="nav-content">
            <mat-icon class="nav-icon">assignment</mat-icon>
            <span *ngIf="!sidebarCollapsed" class="nav-text">Assignments</span>
          </div>
        </div>

        <!-- Assignment Submissions -->
        <div class="nav-item" routerLinkActive="active" routerLink="/admin/assignment-submissions" [routerLinkActiveOptions]="{exact: false}" [attr.data-tooltip]="sidebarCollapsed ? 'Assignment Submissions' : null">
          <div class="nav-content">
            <mat-icon class="nav-icon">assignment_turned_in</mat-icon>
            <span *ngIf="!sidebarCollapsed" class="nav-text">Assignment Submissions</span>
          </div>
        </div>

        <!-- Meetings Management -->
        <div class="nav-item" routerLinkActive="active" routerLink="/admin/manage-meetings" [attr.data-tooltip]="sidebarCollapsed ? 'Meetings' : null">
          <div class="nav-content">
            <mat-icon class="nav-icon">videocam</mat-icon>
            <span *ngIf="!sidebarCollapsed" class="nav-text">Meetings</span>
          </div>
        </div>

        <!-- Meeting Analytics -->
        <div class="nav-item" routerLinkActive="active" routerLink="/admin/meeting-analytics" [attr.data-tooltip]="sidebarCollapsed ? 'Meeting Analytics' : null">
          <div class="nav-content">
            <mat-icon class="nav-icon">analytics</mat-icon>
            <span *ngIf="!sidebarCollapsed" class="nav-text">Meeting Analytics</span>
          </div>
        </div>

        <!-- Doubts Management -->
        <div class="nav-item" routerLinkActive="active" routerLink="/admin/doubts" [attr.data-tooltip]="sidebarCollapsed ? 'Doubts Management' : null">
          <div class="nav-content">
            <mat-icon class="nav-icon">help_outline</mat-icon>
            <span *ngIf="!sidebarCollapsed" class="nav-text">Doubts Management</span>
          </div>
        </div>

        <!-- Feedback Management -->
        <div class="nav-item" routerLinkActive="active" routerLink="/admin/feedback" [attr.data-tooltip]="sidebarCollapsed ? 'Feedback Management' : null">
          <div class="nav-content">
            <mat-icon class="nav-icon">feedback</mat-icon>
            <span *ngIf="!sidebarCollapsed" class="nav-text">Feedback Management</span>
          </div>
        </div>


        <!-- Divider -->
        <div class="nav-divider" *ngIf="!sidebarCollapsed"></div>

        <!-- Profile Settings -->
        <div class="nav-item" routerLinkActive="active" routerLink="/admin/profile" [attr.data-tooltip]="sidebarCollapsed ? 'Profile Settings' : null">
          <div class="nav-content">
            <mat-icon class="nav-icon">settings</mat-icon>
            <span *ngIf="!sidebarCollapsed" class="nav-text">Profile Settings</span>
          </div>
        </div>
      </nav>
    </mat-sidenav>

    <!-- Main Content -->
    <mat-sidenav-content class="main-content">
      <!-- Top Toolbar -->
      <mat-toolbar class="top-toolbar">
        <span class="spacer"></span>
        
        <!-- Search -->
        <div class="search-container">
          <mat-icon>search</mat-icon>
          <input type="text" placeholder="Search..." class="search-input">
        </div>
        
        <!-- Notifications -->
        <app-notification-bell></app-notification-bell>
        
        <!-- User Info -->
        <div class="user-info" *ngIf="currentUser$ | async as currentUser">
          <span class="user-name">{{ currentUser.firstName }} {{ currentUser.lastName }}</span>
          <span class="user-role">{{ currentUser.role | titlecase }}</span>
        </div>
        
        <!-- Profile -->
        <button mat-icon-button class="profile-button" routerLink="/admin/profile" title="Profile Settings">
          <div class="profile-avatar">
            <img *ngIf="(currentUser$ | async)?.profilePicture" 
                 [src]="(currentUser$ | async)?.profilePicture" 
                 alt="Profile"
                 class="profile-picture">
            <mat-icon *ngIf="!(currentUser$ | async)?.profilePicture">account_circle</mat-icon>
          </div>
        </button>
        
        <!-- Logout -->
        <button mat-icon-button class="logout-button" (click)="logout()" title="Logout">
          <mat-icon>logout</mat-icon>
        </button>
      </mat-toolbar>

      <!-- Page Content -->
      <div class="page-content">
        <ng-content></ng-content>
      </div>
    </mat-sidenav-content>
  </mat-sidenav-container>
</div>
