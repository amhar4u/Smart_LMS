<!-- Student Layout -->
<app-student-layout *ngIf="userRole === 'student'">
  <div class="notifications-page">
    <!-- Header -->
    <div class="page-header">
      <button class="back-btn" (click)="goBack()">
        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <polyline points="15 18 9 12 15 6"></polyline>
        </svg>
        Back
      </button>
      <h1>Notifications</h1>
      <div class="header-actions">
        <button class="action-btn" (click)="markAllAsRead()" *ngIf="hasUnreadNotifications()">
          <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <polyline points="20 6 9 17 4 12"></polyline>
          </svg>
          Mark All Read
        </button>
        <button class="action-btn delete-btn" (click)="deleteAllRead()" *ngIf="hasReadNotifications()">
          <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <polyline points="3 6 5 6 21 6"></polyline>
            <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path>
          </svg>
          Delete All Read
        </button>
      </div>
    </div>

  <!-- Filters -->
  <div class="filters">
    <button 
      class="filter-btn"
      [class.active]="activeFilter === 'all'"
      (click)="setFilter('all')">
      All ({{ notifications.length }})
    </button>
    <button 
      class="filter-btn"
      [class.active]="activeFilter === 'unread'"
      (click)="setFilter('unread')">
      Unread ({{ getUnreadCount() }})
    </button>
    <button 
      class="filter-btn"
      [class.active]="activeFilter === 'read'"
      (click)="setFilter('read')">
      Read ({{ getReadCount() }})
    </button>
  </div>

  <!-- Loading State -->
  <div class="loading-state" *ngIf="isLoading">
    <div class="spinner"></div>
    <p>Loading notifications...</p>
  </div>

  <!-- Notifications List -->
  <div class="notifications-container" *ngIf="!isLoading">
    <!-- Empty State -->
    <div class="empty-state" *ngIf="filteredNotifications.length === 0">
      <svg xmlns="http://www.w3.org/2000/svg" width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
        <path d="M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"></path>
        <path d="M13.73 21a2 2 0 0 1-3.46 0"></path>
      </svg>
      <h2>No notifications</h2>
      <p>{{ activeFilter === 'all' ? "You're all caught up!" : `No ${activeFilter} notifications` }}</p>
    </div>

    <!-- Notification Items -->
    <div 
      class="notification-card" 
      *ngFor="let notification of filteredNotifications"
      [class.unread]="!notification.isRead"
      [style.border-left-color]="getColor(notification.priority)"
      (click)="onNotificationClick(notification)">
      
      <!-- Icon -->
      <div class="notification-icon" [style.background-color]="getColor(notification.priority) + '20'">
        <span class="emoji-icon">{{ getIcon(notification.type) }}</span>
      </div>

      <!-- Content -->
      <div class="notification-content">
        <div class="notification-header">
          <h3 class="notification-title">{{ notification.title }}</h3>
          <span class="notification-time">{{ getTimeAgo(notification.createdAt) }}</span>
        </div>
        <p class="notification-message">{{ notification.message }}</p>
      </div>

      <!-- Actions -->
      <div class="notification-actions">
        <button 
          class="action-icon-btn mark-read"
          *ngIf="!notification.isRead"
          (click)="markAsRead($event, notification)"
          title="Mark as read">
          <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <polyline points="20 6 9 17 4 12"></polyline>
          </svg>
        </button>
        <button 
          class="action-icon-btn delete"
          (click)="deleteNotification($event, notification._id)"
          title="Delete">
          <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <line x1="18" y1="6" x2="6" y2="18"></line>
            <line x1="6" y1="6" x2="18" y2="18"></line>
          </svg>
        </button>
      </div>
    </div>
  </div>
  </div>
</app-student-layout>

<!-- Lecturer Layout -->
<app-lecturer-layout *ngIf="userRole === 'teacher'">
  <div class="notifications-page">
    <!-- Header -->
    <div class="page-header">
      <button class="back-btn" (click)="goBack()">
        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <polyline points="15 18 9 12 15 6"></polyline>
        </svg>
        Back
      </button>
      <h1>Notifications</h1>
      <div class="header-actions">
        <button class="action-btn" (click)="markAllAsRead()" *ngIf="hasUnreadNotifications()">
          <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <polyline points="20 6 9 17 4 12"></polyline>
          </svg>
          Mark All Read
        </button>
        <button class="action-btn delete-btn" (click)="deleteAllRead()" *ngIf="hasReadNotifications()">
          <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <polyline points="3 6 5 6 21 6"></polyline>
            <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path>
          </svg>
          Delete All Read
        </button>
      </div>
    </div>

    <!-- Filters -->
    <div class="filters">
      <button 
        class="filter-btn"
        [class.active]="activeFilter === 'all'"
        (click)="setFilter('all')">
        All ({{ notifications.length }})
      </button>
      <button 
        class="filter-btn"
        [class.active]="activeFilter === 'unread'"
        (click)="setFilter('unread')">
        Unread ({{ getUnreadCount() }})
      </button>
      <button 
        class="filter-btn"
        [class.active]="activeFilter === 'read'"
        (click)="setFilter('read')">
        Read ({{ getReadCount() }})
      </button>
    </div>

    <!-- Loading State -->
    <div class="loading-state" *ngIf="isLoading">
      <div class="spinner"></div>
      <p>Loading notifications...</p>
    </div>

    <!-- Notifications List -->
    <div class="notifications-container" *ngIf="!isLoading">
      <!-- Empty State -->
      <div class="empty-state" *ngIf="filteredNotifications.length === 0">
        <svg xmlns="http://www.w3.org/2000/svg" width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
          <path d="M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"></path>
          <path d="M13.73 21a2 2 0 0 1-3.46 0"></path>
        </svg>
        <h2>No notifications</h2>
        <p>{{ activeFilter === 'all' ? "You're all caught up!" : `No ${activeFilter} notifications` }}</p>
      </div>

      <!-- Notification Items -->
      <div 
        class="notification-card" 
        *ngFor="let notification of filteredNotifications"
        [class.unread]="!notification.isRead"
        [style.border-left-color]="getColor(notification.priority)"
        (click)="onNotificationClick(notification)">
        
        <!-- Icon -->
        <div class="notification-icon" [style.background-color]="getColor(notification.priority) + '20'">
          <span class="emoji-icon">{{ getIcon(notification.type) }}</span>
        </div>

        <!-- Content -->
        <div class="notification-content">
          <div class="notification-header">
            <h3 class="notification-title">{{ notification.title }}</h3>
            <span class="notification-time">{{ getTimeAgo(notification.createdAt) }}</span>
          </div>
          <p class="notification-message">{{ notification.message }}</p>
        </div>

        <!-- Actions -->
        <div class="notification-actions">
          <button 
            class="action-icon-btn mark-read"
            *ngIf="!notification.isRead"
            (click)="markAsRead($event, notification)"
            title="Mark as read">
            <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <polyline points="20 6 9 17 4 12"></polyline>
            </svg>
          </button>
          <button 
            class="action-icon-btn delete"
            (click)="deleteNotification($event, notification._id)"
            title="Delete">
            <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <line x1="18" y1="6" x2="6" y2="18"></line>
              <line x1="6" y1="6" x2="18" y2="18"></line>
            </svg>
          </button>
        </div>
      </div>
    </div>
  </div>
</app-lecturer-layout>

<!-- Admin Layout -->
<app-admin-layout *ngIf="userRole === 'admin'">
  <div class="notifications-page">
    <!-- Header -->
    <div class="page-header">
      <button class="back-btn" (click)="goBack()">
        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <polyline points="15 18 9 12 15 6"></polyline>
        </svg>
        Back
      </button>
      <h1>Notifications</h1>
      <div class="header-actions">
        <button class="action-btn" (click)="markAllAsRead()" *ngIf="hasUnreadNotifications()">
          <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <polyline points="20 6 9 17 4 12"></polyline>
          </svg>
          Mark All Read
        </button>
        <button class="action-btn delete-btn" (click)="deleteAllRead()" *ngIf="hasReadNotifications()">
          <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <polyline points="3 6 5 6 21 6"></polyline>
            <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path>
          </svg>
          Delete All Read
        </button>
      </div>
    </div>

    <!-- Filters -->
    <div class="filters">
      <button 
        class="filter-btn"
        [class.active]="activeFilter === 'all'"
        (click)="setFilter('all')">
        All ({{ notifications.length }})
      </button>
      <button 
        class="filter-btn"
        [class.active]="activeFilter === 'unread'"
        (click)="setFilter('unread')">
        Unread ({{ getUnreadCount() }})
      </button>
      <button 
        class="filter-btn"
        [class.active]="activeFilter === 'read'"
        (click)="setFilter('read')">
        Read ({{ getReadCount() }})
      </button>
    </div>

    <!-- Loading State -->
    <div class="loading-state" *ngIf="isLoading">
      <div class="spinner"></div>
      <p>Loading notifications...</p>
    </div>

    <!-- Notifications List -->
    <div class="notifications-container" *ngIf="!isLoading">
      <!-- Empty State -->
      <div class="empty-state" *ngIf="filteredNotifications.length === 0">
        <svg xmlns="http://www.w3.org/2000/svg" width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
          <path d="M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"></path>
          <path d="M13.73 21a2 2 0 0 1-3.46 0"></path>
        </svg>
        <h2>No notifications</h2>
        <p>{{ activeFilter === 'all' ? "You're all caught up!" : `No ${activeFilter} notifications` }}</p>
      </div>

      <!-- Notification Items -->
      <div 
        class="notification-card" 
        *ngFor="let notification of filteredNotifications"
        [class.unread]="!notification.isRead"
        [style.border-left-color]="getColor(notification.priority)"
        (click)="onNotificationClick(notification)">
        
        <!-- Icon -->
        <div class="notification-icon" [style.background-color]="getColor(notification.priority) + '20'">
          <span class="emoji-icon">{{ getIcon(notification.type) }}</span>
        </div>

        <!-- Content -->
        <div class="notification-content">
          <div class="notification-header">
            <h3 class="notification-title">{{ notification.title }}</h3>
            <span class="notification-time">{{ getTimeAgo(notification.createdAt) }}</span>
          </div>
          <p class="notification-message">{{ notification.message }}</p>
        </div>

        <!-- Actions -->
        <div class="notification-actions">
          <button 
            class="action-icon-btn mark-read"
            *ngIf="!notification.isRead"
            (click)="markAsRead($event, notification)"
            title="Mark as read">
            <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <polyline points="20 6 9 17 4 12"></polyline>
            </svg>
          </button>
          <button 
            class="action-icon-btn delete"
            (click)="deleteNotification($event, notification._id)"
            title="Delete">
            <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <line x1="18" y1="6" x2="6" y2="18"></line>
              <line x1="6" y1="6" x2="18" y2="18"></line>
            </svg>
          </button>
        </div>
      </div>
    </div>
  </div>
</app-admin-layout>
